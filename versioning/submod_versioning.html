<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Software Configuration Management with Git Submodules &mdash; gitWorkInstructions v1.1.1
 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../_static/css/svg.css?v=d3ae3b80" />
      <link rel="stylesheet" type="text/css" href="../_static/css/width.css?v=a0fc712e" />
      <link rel="stylesheet" type="text/css" href="../_static/dark_mode_css/general.css?v=c0a7eb24" />
      <link rel="stylesheet" type="text/css" href="../_static/dark_mode_css/dark.css?v=70edf1c7" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=a34f1657"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
        <script>let toggleHintShow = '';</script>
        <script>let toggleHintHide = '';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script src="../_static/dark_mode_js/default_dark.js?v=fd565c74"></script>
        <script src="../_static/dark_mode_js/theme_switcher.js?v=358d3910"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Continous Deployment" href="../ci/cd.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            gitWorkInstructions
          </a>
              <div class="version">
                v1.1.1

              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Git:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../git/git.html">Git</a></li>
<li class="toctree-l1"><a class="reference internal" href="../git/github.html">Github</a></li>
<li class="toctree-l1"><a class="reference internal" href="../git/templates.html">Templates</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Branches:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../branches/branch_types.html">Branches</a></li>
<li class="toctree-l1"><a class="reference internal" href="../branches/pull_request.html">Pull Requests</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">CI/CD:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ci/ci.html">Continuous Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ci/cd.html">Continous Deployment</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Submodule Config Management:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Software Configuration Management with Git Submodules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#abstract">Abstract</a></li>
<li class="toctree-l2"><a class="reference internal" href="#used-terminology">Used Terminology</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#repository">Repository</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reference">Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="#components">Components</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#base-component">Base Component</a></li>
<li class="toctree-l4"><a class="reference internal" href="#subsystem-component">Subsystem Component</a></li>
<li class="toctree-l4"><a class="reference internal" href="#component">Component</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#git-submodules">Git Submodules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#complexity-of-submodule-versioning">Complexity of Submodule Versioning</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#versioning-of-submodules-via-branches">Versioning of Submodules via Branches</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tagging-and-branching-of-submodule-versions">Tagging and Branching of Submodule Versions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creating-a-component-version">Creating a Component Version</a></li>
<li class="toctree-l3"><a class="reference internal" href="#live-example">Live Example</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#create-a-local-clone-of-the-repo-example-including-the-submodules">Create a local clone of the repo example including the submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#checkout-release-v0-0-1">Checkout Release V0.0.1</a></li>
<li class="toctree-l4"><a class="reference internal" href="#checkout-release-v0-1-0">Checkout Release V0.1.0</a></li>
<li class="toctree-l4"><a class="reference internal" href="#checkout-a-development-branch">Checkout a Development Branch</a></li>
<li class="toctree-l4"><a class="reference internal" href="#versioning-via-gitmodules">Versioning via .gitmodules</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#git-commands-for-different-use-cases">Git Commands for Different Use Cases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#creating-a-repository-with-submodules">Creating a Repository with Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cloning-a-repo-with-submodules">Cloning a Repo with Submodules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#updating-the-repository">Updating the Repository</a></li>
<li class="toctree-l4"><a class="reference internal" href="#changing-a-submodule-branch">Changing a Submodule Branch</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#working-on-a-submodule-patch">Working on a Submodule Patch</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#creating-a-submodule-version">Creating a Submodule Version</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creating-a-new-system-version">Creating a New System Version</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">gitWorkInstructions</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Software Configuration Management with Git Submodules</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/versioning/submod_versioning.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <style>
table, th, td {
  border: 1px solid;
  border-collapse: collapse;
}
</style>
<section id="software-configuration-management-with-git-submodules">
<h1>Software Configuration Management with Git Submodules<a class="headerlink" href="#software-configuration-management-with-git-submodules" title="Link to this heading"></a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="#abstract">Abstract</a></p></li>
<li><p><a class="reference internal" href="#used-terminology">Used Terminology</a></p></li>
<li><p><a class="reference internal" href="#git-submodules">Git Submodules</a></p></li>
<li><p><a class="reference internal" href="#versioning-of-submodules-via-branches">Versioning of Submodules via Branches</a></p></li>
<li><p><a class="reference internal" href="#git-commands-for-different-use-cases">Git Commands for Different Use Case</a></p></li>
</ul>
<section id="abstract">
<h2>Abstract<a class="headerlink" href="#abstract" title="Link to this heading"></a></h2>
<p>The goal of configuration management is to manage and maintain all
components used for the creation of a software system, so that all
users of this software work with defined versions.
This article describes a method using the Git version control system and
submodules to implement detailed versioning of software based system.
The basic idea of this method is to divide a software system into
components that are individually versioned. It is suitable for projects
with high functional safety requirements. The administrative overhead
for all project participants should be kept as low as possible. The
configuration should remain simple to change and document.</p>
</section>
<section id="used-terminology">
<h2>Used Terminology<a class="headerlink" href="#used-terminology" title="Link to this heading"></a></h2>
<section id="repository">
<h3>Repository<a class="headerlink" href="#repository" title="Link to this heading"></a></h3>
<p>A repository in this method is a “standard” Git repository.
All items stored inside such a repository share the version history and
are versioned together “as a whole”. This means that each component with
individual versioning needs its own Git repository.</p>
</section>
<section id="reference">
<h3>Reference<a class="headerlink" href="#reference" title="Link to this heading"></a></h3>
<p>A reference  is a Git submodule definition to a commit
inside another Git repository. These are managed with Git commands or
manual editing of the .gitmodules file. The anatomy of such a reference
in .gitmodules looks like this:</p>
<p><img alt="image" src="../_images/gitmodule_entry.png" /></p>
<p>Each used submodule is defined by such a section within the
.gitmodules file.
The “submodule” line holds the name of the submodule. By default it is
the same as the path entry, but can be customized (–name option for
submodule add). The entries for “path” and “url” are always present,
branch is optional.</p>
<ul class="simple">
<li><p>The path field determines the file path where the submodule will apear
within the working copy of the referencing repository.</p></li>
<li><p>The url field is the access path to the submodule repository. It is
the same URL that is used for a “git clone” of the submodule
repository..</p></li>
<li><p>The “branch” field is optional. It only exists if you want the base
repository to follow a branch of the submodule. It will be used
consistently later when applying this method.</p></li>
</ul>
</section>
<section id="components">
<h3>Components<a class="headerlink" href="#components" title="Link to this heading"></a></h3>
<p>A component is defined as a part of a system that can be versioned
individually. A complete system is created by assembling all components
with specific versions. The division of a system into individual
components is defined at project level. The method only defines an
abstract component model with three hierarchical levels:</p>
<figure class="align-default">
<img alt="https://www.plantuml.com/plantuml/svg/VSsz2i8m68NXFLVnKJUXHLSf6LJetep18UeHIyqFN-AGkxUYGz3gV7ZU4yV11SF6qcrmI3c0FAUh5q9lJGJjl0tUmQK3jIqZU2bfiJSyTcooqEf-L3acsCzPmNGCEA5d2ZFn-bnBgbPDiwIAokncKZqkOBWJ9lfFFccnVD4Y-rBhzzzlz00=" src="https://www.plantuml.com/plantuml/svg/VSsz2i8m68NXFLVnKJUXHLSf6LJetep18UeHIyqFN-AGkxUYGz3gV7ZU4yV11SF6qcrmI3c0FAUh5q9lJGJjl0tUmQK3jIqZU2bfiJSyTcooqEf-L3acsCzPmNGCEA5d2ZFn-bnBgbPDiwIAokncKZqkOBWJ9lfFFccnVD4Y-rBhzzzlz00=" />
</figure>
<section id="base-component">
<h4>Base Component<a class="headerlink" href="#base-component" title="Link to this heading"></a></h4>
<p>A “Base” component represents the complete system as a top-level
element. It defines the complete system as a composition based on
references to other components. Creating a working copy of the system
always starts with this component. Most project use exactly one base
component. Multiple base components can be useful, if a project contains
independent sub-projects. A base component consists of</p>
<ul class="simple">
<li><p>The basic system content of the project, for example the directory
tree, project level documentation and scripts for project management
(tools, build scripts ….)</p></li>
<li><p>References to other versioned components.</p></li>
</ul>
</section>
<section id="subsystem-component">
<h4>Subsystem Component<a class="headerlink" href="#subsystem-component" title="Link to this heading"></a></h4>
<p>A “subsystem” component is a composition of components similar to a base
component. It supports the creation of versioned subsystems, which in
turn consist of components. An example of such a subsystem component is
a communication stack that is composed of services, protocols and device
drivers. The use of subsystems must be decided at the project level.
They allow for a finer structuring of the system, but also increase the
effort required for its configuration. For each subsystem, the
references to its components must be maintained in addition to those of
the base component. The content of a subsystem component is analogous to
the base component, but limited to the scope of the subsystem.</p>
</section>
<section id="component">
<h4>Component<a class="headerlink" href="#component" title="Link to this heading"></a></h4>
<p>A “component” forms the lowest level in the hierarchy. It represents a
partial aspect of the complete system that is no longer subdivided. It
contains only one a file tree with no further references to other
components.</p>
</section>
</section>
</section>
<section id="git-submodules">
<h2>Git Submodules<a class="headerlink" href="#git-submodules" title="Link to this heading"></a></h2>
<section id="introduction">
<h3>Introduction<a class="headerlink" href="#introduction" title="Link to this heading"></a></h3>
<p>This configuration method is based on the Git Submodule functionality
for the recursive composition of Git repositories. This functionality is
applied 1:1 to the composition of components via references. There is no
separate tooling required. Any Git tutorial can be used to get a basic
understanding of the Git submodules (Example:
<a class="reference external" href="https://git-scm.com/book/en/v2/Git-Tools-Submodules">https://git-scm.com/book/en/v2/Git-Tools-Submodules</a>).
A disadvantage of Git submodules is the need to deal with additional Git
commands or options for standard operations such as “clone” and
“checkout” of branches (e.g. “git checkout development
<strong>–recurse-submodules</strong> “). But this is defined by Git and not caused
by this methodology.</p>
</section>
<section id="complexity-of-submodule-versioning">
<h3>Complexity of Submodule Versioning<a class="headerlink" href="#complexity-of-submodule-versioning" title="Link to this heading"></a></h3>
<p>Git manages submodules in two distinct places within a repository:</p>
<ul class="simple">
<li><p>Via the .gitmodules file in the root directory of a repository</p></li>
<li><p>Within the repository index under .git/modules and in .git/config.</p></li>
</ul>
<p>The settings in the .gitmodules file are under version control and
visible to a user in the working copy. But sadly this file is primarily
used to register submodules (URL + checkout path). The effectively used
version is a reference to a commit id of the submodule, which is stored
in the index and not in the .gitmodules file. This leads to the
following problems:</p>
<ul class="simple">
<li><p>The contents of the .gitmodules file does not contain all the
information about a submodule configuration.</p></li>
<li><p>It is not possible to specify the commit id via a tag within the
.gitmodules file.</p></li>
<li><p>The Git submodule commands only show commit hashes. Used labels and
branches must be determined via additional detours.</p></li>
</ul>
<p>This complicates both the configuration and the documentation of the
used versions for a complete system. Ideally this should be visible
from a central location, e.g. within the .gitmodules files.
Unfortunately tags are not supported there to request defined
versions of submodules. An alternative to the missing tags support is
possible via branches by using the optional “branch” entry. This avoids
the problems above without having to invent additional scripting/tooling
for the versioning. It can then be managed completely via .gitmodules
based on branches.</p>
</section>
</section>
<section id="versioning-of-submodules-via-branches">
<h2>Versioning of Submodules via Branches<a class="headerlink" href="#versioning-of-submodules-via-branches" title="Link to this heading"></a></h2>
<p>The central idea of the method is a consequent use of branches for
submodules for both, development and configuration management. The
versions of the components are controlled <strong>only</strong> using “branch”
entries in .gitmodules. This restriction has the following benefits:</p>
<ul class="simple">
<li><p>The configuration of the complete system is entirely defined by the
.gitmodules files in the base component and any subsystem component.</p></li>
<li><p>The component configuration is documented and easily readable by
everyone when checking out a configuration.</p></li>
<li><p>The configuration documentation is ensured to be correct as it is also
read and used by the Git operations.</p></li>
<li><p>The workflows for creating development and release versions are the
same.</p></li>
</ul>
<p>These branches should be read-only once created, as they can be used as trackers for the submodule file.</p>
<p>Example:</p>
<p><img alt="image" src="../_images/gitmodule_banch_versions.png" /></p>
<p>In this example, the system uses two submodules named “subm/a” and
“subm/b”. Each one is pointing to a branch within its subsystem
repository.</p>
<section id="tagging-and-branching-of-submodule-versions">
<h3>Tagging and Branching of Submodule Versions<a class="headerlink" href="#tagging-and-branching-of-submodule-versions" title="Link to this heading"></a></h3>
<p>The used version of a component is typically marked by a tag. A tag is
hardwired to a commit, which then reliably represents the desired
state of this version. Git unfortunately only supports branches and no
tags within the .gitmodules file. This method therefore uses branches as
an alternative to the tag in versioning. Git then follows (“tracks”)
this branch, which means that the submodule commit of the branch HEAD
will get used. This leads to an obvious problem compared to tags usage.
Pushes to a branch change its HEAD and as such leave the originally
versioned commit. This problem can be mitigated as follows.</p>
<ul class="simple">
<li><p>Git repository hosting environments like Github or BitBucket support
rights management for branches. It is possible to prohibit the
modification of certain branches or restrict them to privileged users.
A branch behaves then logically in the same way as a tag. It always
represents the same commit.</p></li>
<li><p>The ability to change a release branch may even be desirable if bug
fixes are to be performed during release phases. However, further
changes after the release phase need to be avoided.</p></li>
<li><p>An additional release <strong>Tag</strong> gets created that is pointing to the
same commit as the branch HEAD. The “git submodule status” command
then shows, if the branch has moved away from this label by further
commits. This allows an unintentional change to be detected, for
example by a script inside an CI system.</p></li>
</ul>
</section>
<section id="creating-a-component-version">
<h3>Creating a Component Version<a class="headerlink" href="#creating-a-component-version" title="Link to this heading"></a></h3>
<p>When a component is ready for versioning, the following steps are
performed:</p>
<ol class="arabic simple">
<li><p>A release tag is created on the targeted commit: “git tag -m
“Release X.Y.Z” VX.Y.Z &lt;commit-id&gt;”</p></li>
<li><p>A release branch is created from the above release tag: “git branch
release/vX.Y.Z VX.Y.Z”</p></li>
<li><p>The tags and the branch are “pushed”.</p></li>
</ol>
<p>A successful creation of a component version will then looks like this:</p>
<p><img alt="image" src="../_images/submodule_versioning.png" /></p>
<p>There is a label and a release branch for each release. The release
branches are pushed.</p>
</section>
<section id="live-example">
<h3>Live Example<a class="headerlink" href="#live-example" title="Link to this heading"></a></h3>
<p>A demo repository for demonstrating the submodule versioning with
branches is available in BitBucket. The clone URL is
<a class="reference external" href="https://bitbucket.org/nhjschulz/base.git">https://bitbucket.org/nhjschulz/base.git</a>.</p>
<section id="create-a-local-clone-of-the-repo-example-including-the-submodules">
<h4>Create a local clone of the repo example including the submodules<a class="headerlink" href="#create-a-local-clone-of-the-repo-example-including-the-submodules" title="Link to this heading"></a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>https://bitbucket.org/nhjschulz/base.git<span class="w"> </span>--recurse-submodules
Cloning<span class="w"> </span>into<span class="w"> </span><span class="s1">&#39;base&#39;</span>...
&lt;..&gt;
Submodule<span class="w"> </span>path<span class="w"> </span><span class="s1">&#39;subm/a&#39;</span>:<span class="w"> </span>checked<span class="w"> </span>out<span class="w"> </span><span class="s1">&#39;c776b6f3ae2e58de0b1dd05302b48004b23492c5&#39;</span>
Submodule<span class="w"> </span>path<span class="w"> </span><span class="s1">&#39;subm/b&#39;</span>:<span class="w"> </span>checked<span class="w"> </span>out<span class="w"> </span><span class="s1">&#39;ee28a60fabf10470991d83615021650987885c71&#39;</span>
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>base
$<span class="w"> </span>git<span class="w"> </span>branch<span class="w"> </span>-a
*<span class="w"> </span>main
remotes/origin/HEAD<span class="w"> </span>-&gt;<span class="w"> </span>origin/main
remotes/origin/development
remotes/origin/main
remotes/origin/release/v0.0.1
remotes/origin/release/v0.1.0
</pre></div>
</div>
<p>Important is the use of the “–recurse-submodules” option for the clone command.
The submodules will not be loaded in the context of cloning without this
option. But they can still be loaded later on using additional Git
commands.
In addition to the “main” branch, the repository also contains release
branches and a “development” branch.</p>
</section>
<section id="checkout-release-v0-0-1">
<h4>Checkout Release V0.0.1<a class="headerlink" href="#checkout-release-v0-0-1" title="Link to this heading"></a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>checkout<span class="w"> </span>release/v0.0.1<span class="w">  </span>--recurse-submodules
branch<span class="w"> </span><span class="s1">&#39;release/v0.0.1&#39;</span><span class="w"> </span><span class="nb">set</span><span class="w"> </span>up<span class="w"> </span>to<span class="w"> </span>track<span class="w"> </span><span class="s1">&#39;origin/release/v0.0.1&#39;</span>.
Switched<span class="w"> </span>to<span class="w"> </span>a<span class="w"> </span>new<span class="w"> </span>branch<span class="w"> </span><span class="s1">&#39;release/v0.0.1&#39;</span>
$<span class="w"> </span>git<span class="w"> </span>submodule<span class="w"> </span>status
<span class="w"> </span>1cc129c0c4bba38384149e53a1143b8b4a370a30<span class="w"> </span>subm/a<span class="w"> </span><span class="o">(</span>V0.0.1<span class="o">)</span>
<span class="w"> </span>ee28a60fabf10470991d83615021650987885c71<span class="w"> </span>subm/b<span class="w"> </span><span class="o">(</span>V0.0.1<span class="o">)</span>
</pre></div>
</div>
<p>The repository working copy is now represents the release V0.0.1 state.
The submodule repositories are also using “initial” version number.
Note that each submodule uses its own “release/v0.0.1” branch here.</p>
</section>
<section id="checkout-release-v0-1-0">
<h4>Checkout Release V0.1.0<a class="headerlink" href="#checkout-release-v0-1-0" title="Link to this heading"></a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>checkout<span class="w"> </span>release/v0.1.0<span class="w">  </span>--recurse-submodules
branch<span class="w"> </span><span class="s1">&#39;release/v0.1.0&#39;</span><span class="w"> </span><span class="nb">set</span><span class="w"> </span>up<span class="w"> </span>to<span class="w"> </span>track<span class="w"> </span><span class="s1">&#39;origin/release/v0.1.0&#39;</span>.
Switched<span class="w"> </span>to<span class="w"> </span>a<span class="w"> </span>new<span class="w"> </span>branch<span class="w"> </span><span class="s1">&#39;release/v0.1.0&#39;</span>
$<span class="w"> </span>git<span class="w"> </span>submodule<span class="w"> </span>status
<span class="w"> </span>c776b6f3ae2e58de0b1dd05302b48004b23492c5<span class="w"> </span>subm/a<span class="w"> </span><span class="o">(</span>V0.1.0<span class="o">)</span>
<span class="w"> </span>ee28a60fabf10470991d83615021650987885c71<span class="w"> </span>subm/b<span class="w"> </span><span class="o">(</span>V0.0.1<span class="o">)</span>
</pre></div>
</div>
<p>The switch to release V0.1.0 also changed the version of submodule
“subm/a”. It also advanced to V0.1.0. The second submodule “subm/b”
didn’t switch in this version and is still using the V0.0.1.</p>
</section>
<section id="checkout-a-development-branch">
<h4>Checkout a Development Branch<a class="headerlink" href="#checkout-a-development-branch" title="Link to this heading"></a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>checkout<span class="w"> </span>development<span class="w">  </span>--recurse-submodules
branch<span class="w"> </span><span class="s1">&#39;development&#39;</span><span class="w"> </span><span class="nb">set</span><span class="w"> </span>up<span class="w"> </span>to<span class="w"> </span>track<span class="w"> </span><span class="s1">&#39;origin/development&#39;</span>.
Switched<span class="w"> </span>to<span class="w"> </span>a<span class="w"> </span>new<span class="w"> </span>branch<span class="w"> </span><span class="s1">&#39;development&#39;</span>
$<span class="w"> </span>git<span class="w"> </span>submodule<span class="w"> </span>status
<span class="w"> </span>382a28f0d54609483a6843c5f13d879868b7b809<span class="w"> </span>subm/a<span class="w"> </span><span class="o">(</span>V0.1.0-2-g382a28f<span class="o">)</span>
<span class="w"> </span>ef9039e996aba89c30c75fecd8fb0a82e32bc1bf<span class="w"> </span>subm/b<span class="w"> </span><span class="o">(</span>V0.0.1-4-gef9039e<span class="o">)</span>
</pre></div>
</div>
<p>The switch to branch development has affected both submodules. The
cryptic output <strong>V0.1.0-2-g382a28f</strong> in this case means that we are two
commits behind the label V0.1.0 on commit “382a28f…”. It shows
that we no longer have tagged versiones of the submodules in our working
copy. But since we’re on a “development” branch, that’s probably what we
expect. We likely got the latest state of these components now.</p>
</section>
<section id="versioning-via-gitmodules">
<h4>Versioning via .gitmodules<a class="headerlink" href="#versioning-via-gitmodules" title="Link to this heading"></a></h4>
<p>The versioning of complete demo system got defined exclusively by the
base component (there had been no additional subsystem components).
Release branches of the base component refer to well defined versions of
the submodule inside the .gitmodules file. Here is an overview of the
various .gitmodules contents of the branches in the base component. They
differ only in the value of the branch field. This is exactly the
desired effect of this method. The .gitmodules file together with the
base component version define and documents the versioning of the entire
system.</p>
<p><img alt="image" src="../_images/gitmodules_diffs.png" /></p>
</section>
</section>
</section>
<section id="git-commands-for-different-use-cases">
<h2>Git Commands for Different Use Cases<a class="headerlink" href="#git-commands-for-different-use-cases" title="Link to this heading"></a></h2>
<p>This section shows Git command examples for various versioning use
cases. In many cases, there are alternative commands that lead to same
results. The commands shown here are considered examples to get started
using submodule versioning. Advanced users may follow other routes or
add scripts for automation. Commands using <strong>bold font</strong> in the left
column are to be executed inside the folder of the submodule component.
Otherwise the base component folder will be used.</p>
<section id="creating-a-repository-with-submodules">
<h3>Creating a Repository with Submodules<a class="headerlink" href="#creating-a-repository-with-submodules" title="Link to this heading"></a></h3>
<table>
<colgroup>
<col style="width: 20%" />
<col style="width: 30%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Commands</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>mkdir &lt;<em>name&gt;</em></td>
<td>Creation of an empty folder for the base component named "name"</td>
<td>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ mkdir basis
</pre></div>
</div>
</td>
</tr>
<tr class="even">
<td>cd <em>&lt;name&gt;</em></td>
<td>Switching into the base component repository. </td>
<td>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ cd basis
</pre></div>
</div>
</td>
</tr>
<tr class="odd">
<td>git init</td>
<td>Creation of a new Git Repository
<td><p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ git init
Initialized empty Git repository in
/home/norbert/basis/.git/
</pre></div>
</div>
</td>
</tr>
<tr class="even">
<td>git submodule add &lt;repo_url&gt; &lt;local_relative_path&gt;</td>
<td>Adding submodules. This command is repeated for each submodule.</td>
<td>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ git submodule add https://bitbucket.org/nhjschulz/subm_a.git submod/a
Cloning into &#39;/home/norbert/basis/submod/a&#39;...
remote: Enumerating objects: 36, done.
remote: Counting objects: 100% (36/36), done.
remote: Compressing objects: 100% (26/26), done.
remote: Total 36 (delta 0), reused 0 (delta 0), pack-reused 0 (from 0)
Receiving objects: 100% (36/36), done.
</pre></div>
</div>
</td>
</tr>
<tr class="odd">
<td>git status</td>
<td>Check the current status. Adding submodules resulted in changes that
need to be checked in.<br>A directory got created for each submodule and
the .gitmodules file was created or extended.</td>
<td>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ git status
On branch master

No commits yet

Changes to be committed:
  (use &quot;git rm --cached &lt;file&gt;...&quot; to unstage)
        new file:   .gitmodules
        new file:   submod/a
</pre></div>
</div>
</td>
</tr>
<tr class="even">
<td>git commit -a -m "&lt;msg&gt;"</td>
<td>Check-in and commit of the modified submodule definitions.</td>
<td>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>  $ git commit -a -m &quot;Added Submodule  https://bitbucket.org/nhjschulz/subm_a.git&quot;
  [master (root-commit) 1054429] Added Submodule  https://bitbucket.org/nhjschulz/subm_a.git
   2 files changed, 4 insertions(+)
   create mode 100644 .gitmodules
   create mode 160000 submod/a
</pre></div>
</div>
  </td>
  </tr>
  </tbody>
  </table>
</section>
<section id="cloning-a-repo-with-submodules">
<h3>Cloning a Repo with Submodules<a class="headerlink" href="#cloning-a-repo-with-submodules" title="Link to this heading"></a></h3>
<table>
<colgroup>
<col style="width: 20%" />
<col style="width: 30%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Commands</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>git clone &lt;url&gt; &nbsp; --recurse-submodules</td>
<td><p>Initial cloning of a repository including all submodules. This is
achieved by using the "--recurse-submodules" option.</p>
<p>Use the following commands if "--recurse-submodules" has been
forgotten during clone. This option is primarily a convenience to do
this automatically:</p>
<p>$ git submodule init<br>
Submodule 'subm/a' (https://bitbucket.org/nhjschulz/subm_a.git) registered for path
'subm/a'<br>
Submodule 'subm/b' (https://bitbucket.org/nhjschulz/subm_b.git) registered for path
'subm/b</p>
<p>'$ git submodule update</p>
<p>Cloning into '/home/norbert/submod_cfgmgmt/base/subm/a'...<br>
Cloning into '/home/norbert/submod_cfgmgmt/base/subm/b'...<br>
Submodule path 'subm/a': checked out
'c776b6f3ae2e58de0b1dd05302b48004b23492c5'<br>
Submodule path 'subm/b':checked out 'ee28a60fabf10470991d83615021650987885c71'</p>
</td>
<td>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ git clone https://bitbucket.org/nhjschulz/base.git --recurse-submodules
Cloning into &#39;base&#39;...
remote: Enumerating objects: 34, done.
remote: Counting objects: 100% (34/34), done.
remote: Compressing objects: 100% (31/31), done.
remote: Total 34 (delta 9), reused 0 (delta 0), pack-reused 0 (from 0)
Receiving objects: 100% (34/34), done.
Resolving deltas: 100% (9/9), done.
Submodule &#39;subm/a&#39; (https://bitbucket.org/nhjschulz/subm_a.git) registered for path &#39;subm/a&#39;
Submodule &#39;subm/b&#39; (https://bitbucket.org/nhjschulz/subm_b.git) registered for path &#39;subm/b&#39;
Cloning into &#39;/home/norbert/submod_cfgmgmt/base/subm/a&#39;...
remote: Enumerating objects: 36, done.
remote: Counting objects: 100% (36/36), done.
remote: Compressing objects: 100% (26/26), done.
remote: Total 36 (delta 0), reused 0 (delta 0), pack-reused 0 (from 0)
Receiving objects: 100% (36/36), done.
Cloning into &#39;/home/norbert/submod_cfgmgmt/base/subm/b&#39;...
remote: Enumerating objects: 29, done.
remote: Counting objects: 100% (29/29), done.
remote: Compressing objects: 100% (21/21), done.
remote: Total 29 (delta 1), reused 0 (delta 0), pack-reused 0 (from 0)
Receiving objects: 100% (29/29), done.
Resolving deltas: 100% (1/1), done.
Submodule path &#39;subm/a&#39;: checked out &#39;c776b6f3ae2e58de0b1dd05302b48004b23492c5&#39;
Submodule path &#39;subm/b&#39;: checked out &#39;ee28a60fabf10470991d83615021650987885c71&#39; &#39;
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<section id="updating-the-repository">
<h4>Updating the Repository<a class="headerlink" href="#updating-the-repository" title="Link to this heading"></a></h4>
<table>
<colgroup>
<col style="width: 20%" />
<col style="width: 30%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Commands</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>git pull</td>
<td>The base repository is updated by a pull. It updates the base
component working copy, but does not touch the submodules yet.</td>
<td>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ git pull
remote: Enumerating objects: 1, done.
remote: Counting objects: 100% (1/1), done.
remote: Total 1 (delta 0), reused 0 (delta 0), pack-reused 0 (from 0)
Unpacking objects: 100% (1/1), 149 bytes | 149.00 KiB/s, done.&lt;/td&gt;
</pre></div>
</div>
</tr>
<tr class="even">
<td>git submodule update --init --recursive --remote</td>
<td>The submodules are updated to the commits of the branch HEADs as
defined by the .gitmodules file.</td>
<td>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ git submodule update --init --recursive --remote
Submodule path &#39;subm/a&#39;: checked out&#39;382a28f0d54609483a6843c5f13d879868b7b809&#39;
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<p>Git pull also offers a “–recurse-submodules” option, which automatically adjusts the submodules as well.
However, this only works with already known submodules.
If new entries appear in .gitmodules with the pull, they will not be processed and a
“submodule update” will still be necessary. It is currently more safe to go with
the sequence of pull and “submodule update”.</p>
</section>
<section id="changing-a-submodule-branch">
<span id="id1"></span><h4>Changing a Submodule Branch<a class="headerlink" href="#changing-a-submodule-branch" title="Link to this heading"></a></h4>
<p>This scenario describes the change of a submodule to another existing
branch.</p>
<ul class="simple">
<li><p>Integrators use it to update submodules to point to new versions. In
this case, the base component should be on an integration branch.</p></li>
<li><p>Developers use this to set submodules to a development branch for
further development. In this case, the base component should be also
on a development branch (e.g. feature/x or development).</p></li>
</ul>
<table>
<colgroup>
<col style="width: 20%" />
<col style="width: 30%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Commands</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>git checkout &lt;branch&gt;</td>
<td>Set the base component to the target branch (integration or
development branch).</td>
<td>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>  $ git checkout development
  Switched to branch &#39;development&#39;
  Your branch is up to date with &#39;origin/development&#39;.
</pre></div>
</div>
</td>
</tr>
<tr class="even">
<td>git submodule set-branch --branch &lt;branch&gt; &lt;module&gt;</td>
<td>Create a branch entry for a submodule in .gitmodules. This command
is repeated for all submodules whose branch is to be switched.</td>
<td>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>  $ git submodule set-branch --branch development subm/a
</pre></div>
</div>
</tr>
<tr class="odd">
<td>git diff</td>
<td><p>With <strong>git diff</strong> you can see that the branch of the
submodule has been changed inside .gitmodules.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only the entry in the .gitmodules file has been adjusted.
The submodule versions in the working copy have not (yet) changed.</p>
</div>
</td>
<td>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ git diff
diff --git a/.gitmodules b/.gitmodules
index 7cb7f77..01af15d 100644
--- a/.gitmodules
+++ b/.gitmodules
@@ -1,7 +1,7 @@
    [submodule &quot;subm/a&quot;]
    path = subm/a
    url = https://bitbucket.org/nhjschulz/subm_a.git
-   branch = release/v0.1.0&lt;br /&gt;
+   branch = development&lt;br /&gt;
[submodule &quot;subm/b&quot;]&lt;br /&gt;
  path = subm/b&lt;br /&gt;
  url = https://bitbucket.org/nhjschulz/subm_b.git
</pre></div>
</div>
</tr>
<tr class="even">
<td>git submodule update --recursive --remote</td>
<td>Apply the changes in .gitmodules to the submodules. This sets the
commit reference in the index to the HEAD of the branch and checks it
out. The "--remote" causes changes from the upstream submodule repository
to be fetched first, and then switch to the HEAD of the branches.</td>
<td>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ git submodule update --recursive --remote
Submodule path &#39;subm/a&#39;: checked out &#39;382a28f0d54609483a6843c5f13d879868b7b809&#39;
</pre></div>
</div>
</td>
</tr>
<tr class="odd">
<td>git status</td>
<td>A status check shows that we need to check in the changes to
.gitmodules and the and the module's directory. At least .gitmodules and
all changed submodule folders must be checked in.</td>
<td>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ git status
On branch main
Your branch is up to date with &#39;origin/main&#39;.

Changes not staged for commit:
(use &quot;git add &lt;file&gt;...&quot; to update what will be committed)
(use &quot;git restore &lt;file&gt;...&quot; to discard changes in working directory)
    modified:   .gitmodules
    modified:   subm/a (new commits)
</pre></div>
</div>
</td>
</tr>
<tr class="even">
<td>git commit -a -m "&lt;msg&gt;"</td>
<td>Check in of the submodule branch changes.</td>
<td>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ git commit -a -m &quot;Changed Submodule A to development branch&quot;
[main d695de1] Changed Submodule A to development branch
2 files changed, 2 insertions(+), 2 deletions(-)
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="working-on-a-submodule-patch">
<h3>Working on a Submodule Patch<a class="headerlink" href="#working-on-a-submodule-patch" title="Link to this heading"></a></h3>
<p>A Git submodule is a normal Git repository. It is only located within a
base repository, which monitors it for modifications. If you switch into
a submodule directory, all Git commands for managing the submodule
repository are available. A special situation arises here, as submodules
are set to a specific commit during update/checkout from the base
repository. Git calls this “detached HEAD” as there is no branch
context. To work in a submodule, it needs first to be switched back to a
branch. Unfortunately, the “branch” specification of the .gitmodules
file does not also cause this branch to be set. Only the HEAD commit of
the branch got checked out. You are on the same commit as the branch
HEAD, but still “detached” from branches.</p>
<p>The following scenario assumes strict version control at the component
level. This means that all components are set to released versions and
you have a defined configuration at the beginning. A component
(submodule) is now to be extended from this state.</p>
<table>
<colgroup>
<col style="width: 20%" />
<col style="width: 30%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Commands</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>git checkout &lt;version&gt;</td>
<td>Check out the desired version in the base component.</td>
<td>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ git checkout release/v0.1.0
Switched to branch &#39;release/v0.1.0&#39;
Your branch is up to date with &#39;origin/release/v0.1.0&#39;.
</pre></div>
</div>
</td>
</tr>
<tr class="even">
<td>cd &lt;submodule&gt;</td>
<td>Switch into the component you want to edit</td>
<td>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ cd subm/a
</pre></div>
</div>
</tr>
<tr class="odd">
<td><p><strong>git status</strong></p>
<p><strong>git log &lt;ID&gt; -n 1</strong></p></td>
<td><p>Check the status of the component. As expected, we are on a
commit with no branch context.</p>
<p>The log command shows that this commit belongs to the V0.1.0 tag  .
Since we want to add a feature to this version, we create a new branch
for it in the next step.
</td>
<td>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ git status
HEAD detached at c776b6f
nothing to commit, working tree clean

$ git log c776b6f -n 1
commit c776b6f3ae2e58de0b1dd05302b48004b23492c5 (HEAD, tag: V0.1.0,origin/release/v0.1.0, release/v0.1.0)
Author: Norbert Schulz &lt;github@schulznorbert.de&gt;
Date:   Mon Sep 30 16:23:33 2024 +0200

    Update 8 on dev branch
</pre></div>
</div>
</tr>
<tr class="even">
<td><strong>git checkout -b &lt;name&gt; &lt;tag&gt;</strong></td>
<td>Create a new branch to edit/update the component. Committing and
pulling of changes is possible after this step.</td>
<td>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ git checkout -b feature/new V0.1.0
Switched to a new branch &#39;feature/new&#39;

$ git status
On branch feature/new
nothing to commit, working tree clean
</pre></div>
</div>
</td>
</tr>
<tr class="odd">
<td><strong>&lt;edit&gt;</strong></td>
<td>"Featue New" gets implemented here.</td>
<td>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ echo &quot;Feature/new is here&quot; &gt; README.md
</pre></div>
</div>
</td>
</tr>
<tr class="even">
<td><strong>git commit -a -m "&lt;msg&gt;"</strong></td>
<td>Check-in of the changes.</td>
<td>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ git commit -a -m &quot;Added Feature New&quot;
[feature/new 4cb7e76] Added Feature New
1 file changed, 1 insertion(+), 1 deletion(-)
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<p>The changes inside the submodule have impact on the base repository as well.
A “git status” in the base repository returns the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>status
On<span class="w"> </span>branch<span class="w"> </span>release/v0.1.0
Your<span class="w"> </span>branch<span class="w"> </span>is<span class="w"> </span>up<span class="w"> </span>to<span class="w"> </span>date<span class="w"> </span>with<span class="w"> </span><span class="s1">&#39;origin/release/v0.1.0&#39;</span>.

Changes<span class="w"> </span>not<span class="w"> </span>staged<span class="w"> </span><span class="k">for</span><span class="w"> </span>commit:
<span class="w">  </span><span class="o">(</span>use<span class="w"> </span><span class="s2">&quot;git add &lt;file&gt;...&quot;</span><span class="w"> </span>to<span class="w"> </span>update<span class="w"> </span>what<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>committed<span class="o">)</span>
<span class="w">  </span><span class="o">(</span>use<span class="w"> </span><span class="s2">&quot;git restore &lt;file&gt;...&quot;</span><span class="w"> </span>to<span class="w"> </span>discard<span class="w"> </span>changes<span class="w"> </span><span class="k">in</span><span class="w"> </span>working
directory<span class="o">)</span>
<span class="w">        </span>modified:<span class="w">   </span>subm/a<span class="w"> </span><span class="o">(</span>new<span class="w"> </span>commits<span class="o">)</span>

no<span class="w"> </span>changes<span class="w"> </span>added<span class="w"> </span>to<span class="w"> </span>commit<span class="w"> </span><span class="o">(</span>use<span class="w"> </span><span class="s2">&quot;git add&quot;</span><span class="w"> </span>and/or<span class="w"> </span><span class="s2">&quot;git commit -a&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p>The base repository has detected that we are now on a different commit
in the modified submodule. If you want to share the new variant,
<strong>you should not check in and push the changed folder</strong> <strong>now</strong>. This will
create a contradiction between .gitmodules and the index commit link.
The previous version branch is still listed in .gitmodules, but the
commit hash in the submodule is the HEAD of the new branch. Possible
options to handle this situation are:</p>
<ul class="simple">
<li><p>Create a development branch in the base module and update the feature
branch of the submodule inside .gitmodules and push. This creates a
“tracking development branch” that can be shared with other
developers.</p></li>
<li><p>Create a new version of the submodule for integration and discard the
local changes with “git submodule update –init –remote –recursive”.
An integrator then later generates an update of the base repository
that targets the new version of the submodule.</p></li>
</ul>
<section id="creating-a-submodule-version">
<h4>Creating a Submodule Version<a class="headerlink" href="#creating-a-submodule-version" title="Link to this heading"></a></h4>
<table>
<colgroup>
<col style="width: 20%" />
<col style="width: 30%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Commands</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>cd &lt;submod-dir&gt;</td>
<td>Switch to the submodule to be versioned,</td>
<td>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ cd subm/a
</pre></div>
</div>
</tr>
<tr class="even">
<td><p><strong>git fetch</strong></p>
<p><strong>git log</strong></p></td>
<td>Determine the commit hash to be versioned. This step is optional if
the hash is already known. The "git fetch" ensures that all existing
hashes are also known in the local repository.</td>
<td>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ git fetch
$ git log
commit 382a28f0d54609483a6843c5f13d879868b7b809 (HEAD, origin/development)
Author: Norbert Schulz &lt;github@schulznorbert.de&gt;
Date:   Mon Sep 30 16:23:33 2024 +0200

    Update 10 on dev branch

commit 7f80e15fb9fdddbce08a4107082ecd6c49061bb1
Author: Norbert Schulz &lt;github@schulznorbert.de&gt;
Date:   Mon Sep 30 16:23:33 2024 +0200

    Update 9 on dev branch
...
</pre></div>
</div>
</td>
</tr>
<tr class="odd">
<td><strong>git tag  -m "version &lt;version&gt;"
&lt;version_tag_name&gt; &lt;hash&gt;</strong></td>
<td>Assign a version tag for the desired commit. In the example it is
V2.0.0.</td>
<td>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ git tag -m &quot;Release V2.0.0&quot; V2.0.0 382a28f0d54609483a6843c5f13d879868b7b809
</pre></div>
</div>
</tr>
<tr class="even">
<td><strong>git branch release/&lt;version&gt;
&lt;version_tag_name&gt;</strong></td>
<td>Create a version branch for the tag you just created.</td>
<td>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>git branch release/v2.0.0 V2.0.0
</pre></div>
</div>
</tr>
<tr class="odd">
<td><strong>git push  --set-upstream origin
&lt;local_branch_name&gt;:&lt;remote_branch_name&gt;</strong></td>
<td>Make the new branch known in the "upstream" repository "origin". The
last parameter contains the branch name twice, separated by a colon. The
name on the left is the banch name in the local repository. The right
name will be the new branch in the "upstream" repository.</td>
<td>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ git push --set-upstream origin release/v2.0.0:release/v2.0.0
To https://bitbucket.org/nhjschulz/subm_a.git
(https://bitbucket.org/nhjschulz/subm_a.git)
 * [new branch]      release/v2.0.0 -&gt; release/v2.0.0
branch &#39;release/v2.0.0&#39; set up to track &#39;origin/release/v2.0.0&#39;.
</pre></div>
</div>
</td>
</tr>
<tr class="even">
<td><strong>git push origin tag &lt;version_tag_name&gt;</strong></td>
<td>Make the release tag known to the "upstream" origin repository. A
"normal" push does not transfer tags.</td>
<td>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ git push origin tag V2.0.0
Enumerating objects: 1, done.Counting objects: 100% (1/1), done.
Writing objects: 100% (1/1), 169 bytes | 169.00 KiB/s, done.
Total 1 (delta 0), reused 0 (delta 0), pack-reused0
To https://bitbucket.org/nhjschulz/subm_a.git
  * [new tag]         V2.0.0
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<p>To use the new version in the base repository, use the commands
from <a class="reference internal" href="#changing-a-submodule-branch">Changing a Submodule Branch</a> and use
the new branch name there.</p>
</section>
<section id="creating-a-new-system-version">
<h4>Creating a New System Version<a class="headerlink" href="#creating-a-new-system-version" title="Link to this heading"></a></h4>
<p>Creating a complete system version starts by creating a new version for
the base component. In this new version, the .gitmodules file will be
edited to update the references to new versions (=branches) of the
submodule components. The new versions for the submodules must already
be available before the update of the base component.</p>
<table>
<colgroup>
<col style="width: 20%" />
<col style="width: 30%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Commands</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>git checkout &lt;Integration_Branch&gt;</td>
<td>In the base repository, the integration branch is checked out.</td>
<td>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ git checkout integration
Switched to branch &#39;integration&#39;
</pre></div>
</div>
</td>
</tr>
<tr class="even">
<td>&lt;update der Submodule Versionen&gt;</td>
<td>On the Integrations branch, the .gitmodules file is edited. The
"branch" entries for components with new versions are adjusted. In the
example, the version of the subm/a component has been increased</td>
<td>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ vi .gitmodules$ git diff
diff --git a/.gitmodules b/.gitmodules
index 7cb7f77..62afcf6 100644
--- a/.gitmodules
+++ b/.gitmodules
@@ -1,7 +1,7 @@
[submodule &quot;subm/a&quot;]
    path = subm/a
    url = https://bitbucket.org/nhjschulz/subm_a.git
-   branch = release/v0.1.0
+   branch = release/v2.0.0
[submodule &quot;subm/b&quot;]
    path = subm/b
    url = https://bitbucket.org/nhjschulz/subm_b.git
</pre></div>
</div>
</td>
</tr>
<tr class="odd">
<td>git submodule update --init --remote --recursive</td>
<td><p>The working copy of the integration branch is updated to the new
component version. The "git status" shows the changes in the submodules
(only subm/a" has changed here).</p>
<p>A integrator may now perform smoke tests on this configuration and
check it in if successful.</p></td>
<td>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ git submodule update --init --remote --recursive
Submodule path &#39;subm/a&#39;: checked out &#39;382a28f0d54609483a6843c5f13d879868b7b809&#39;

$ git status
On branch integration
Changes not staged for commit:
  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)
  (use &quot;git restore &lt;file&gt;...&quot; to discard changes in working directory)
          modified:   .gitmodules
          modified:   subm/a (new commits)
  no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)
</pre></div>
</div>
</td>
</tr>
<tr class="even">
<td><p>git commit -a -m "&lt;msg&gt;"</p>
<p>git push</p></td>
<td>The changes of the integration branch are checked into git and
pushed.<br />
Further tests can now be run on the integration branch, or a new version
can be created right away for testers to work with.</td>
<td>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ git commit -a -m &quot;Preparing Release v2.0.0&quot;
[integration 3b811e2] Preparing Release v2.0.0
2 files changed, 2 insertions(+), 2 deletions(-)

$ git push
Enumerating objects: 7, done.
Counting objects: 100% (7/7), done.
Delta compression using up to 22 threads
Compressing objects: 100% (4/4), done.
Writing objects: 100% (4/4), 391 bytes | 391.00 KiB/s, done.
Total 4 (delta 2), reused 0 (delta 0), pack-reused 0
</pre></div>
</div>
</td>
</tr>
<tr class="odd">
<td><p>git tag -m "Created version &lt;version&gt;"
&lt;tag_version&gt;</p>
<p>git push origin tag &lt;tag_version&gt;</p></td>
<td>A new base component version is created by setting a tag. Unlike
submodules, no branch necessarily has to be created here. The base
component is not included in .submodules.</td>
<td>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ git tag -m &quot;Created version V2.0.0&quot; V2.0.0

$ git push origin tag V2.0.0
 * [new tag]         V2.0.0 -&gt; V2.0.0
</pre></div>
</div>
</td>
</tr>
<tr class="even">
<td><p>git branch release/&lt;version&gt; &lt;tag_version&gt;</p>
<p>git push  --set-upstream origin
&lt;local_branch_name&gt;:&lt;remote_branch_name&gt;</p></td>
<td>Optional: Create a release branch for the new version:</td>
<td>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ git branch release/v2.0.0 V2.0.0

$ git push --set-upstream origin release/v2.0.0:release/v2.0.0
* [new branch]      release/v2.0.0 -&gt;; release/v2.0.0
branch &#39;release/v2.0.0&#39; set up to track &#39;origin/release/v2.0.0&#39;.
</pre></div>
</div>
</tr>
</tbody>
</table>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../ci/cd.html" class="btn btn-neutral float-left" title="Continous Deployment" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024 - present, NewTec GmbH.
      <span class="lastupdated">Last updated on Oct 29, 2024.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>